<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Functions - Form Validering</title>
</head>
<body>

	<form>
        <fieldset>
            <div>
                <label for="firstname">Fornavn</label>
                <input type="text" name="firstname" id="firstname" >
            </div>    
            <div>
                <label for="lastname">Efternavn</label>
                <input type="text" name="lastname" id="lastname" >
            </div>    
            <div>
                <label for="username">Brugernavn</label>
                <input type="text" name="username" id="username" required>
            </div>    
            <div>
                <label for="email">Email</label>
                <input type="email" name="email" id="email">
            </div>    
            <div>
                <button type="button" onclick="validateForm(this.form)">Send</button>
            </div>    
        </fieldset>    
    </form>
	
	<script>
	/**
	 * Funktion til validering af forms
	 * @param {object} form 
	 */
	function validateForm(form) {
		//console.dir(form.firstname.value);

		let result = true;

		const inputs = form.querySelectorAll(':required');

		for(let item of inputs) {
			console.log(item);
			if(!item.value) {
				showError(item)
				let result = false;
				return false;
			}
		}

		if(result) {
			form.submit();
		}
	}

/**
 * Funktion til visning af fejlmeddelelse
 * @param {object} elm HTML element objekt
 */
 function showError(elm) {
  // Tilføjer class til input objekt (rød border)
  elm.classList.add("field-error");
  // Hvis ikke der findes en next sibling
  if (!elm.nextElementSibling) {
    // Tilføj tilstødende sibling efter input element
    elm.insertAdjacentHTML(
      "afterend",
      `<span class="text-error">Du skal udfylde feltet</span>`
    );
    // Tilføj keypress event til input element
    elm.addEventListener("keypress", function () {
      // Fjern sibling hvis den er der
      if (elm.nextElementSibling) {
        elm.nextElementSibling.remove();
      }
      // Fjern class til fejl
      elm.classList.remove('field-error');
      // Tilføj class til success (grøn border)
      elm.classList.add('field-success');
    });
  }
}

	</script>
</body>
</html>